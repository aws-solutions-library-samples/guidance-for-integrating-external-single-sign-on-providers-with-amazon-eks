$ checkov -d /Users/bersr/Documents/Code/Terraform/aws-solutions-library-samples/guidance-for-amazon-eks-integrations-with-external-sso-providers-on-aws/source

[ secrets framework ]: 100%|████████████████████|[7/7], Current File Scanned=/Users/bersr/Documents/Code/Terraform/aws-solutions-library-samples/guidance-for-amazon-eks-integrations-with-external-sso-providers-on-aws/source/vpc.tf      
2024-09-27 19:12:14,512 [ThreadPoolEx] [WARNI]  Failed to download module terraform-aws-modules/eks/aws:~> 20.24 (for external modules, the --download-external-modules flag is required)
2024-09-27 19:12:14,512 [ThreadPoolEx] [WARNI]  Failed to download module terraform-aws-modules/vpc/aws:~> 5.0 (for external modules, the --download-external-modules flag is required)
[ terraform framework ]: 100%|████████████████████|[7/7], Current File Scanned=vpc.tf      


       _               _              
   ___| |__   ___  ___| | _______   __
  / __| '_ \ / _ \/ __| |/ / _ \ \ / /
 | (__| | | |  __/ (__|   < (_) \ V / 
  \___|_| |_|\___|\___|_|\_\___/ \_/  
                                      
By Prisma Cloud | version: 3.2.60 
Update available 3.2.60 -> 3.2.255
Run pip3 install -U checkov to update 


terraform scan results:

Passed checks: 17, Failed checks: 0, Skipped checks: 2

Check: CKV_AWS_358: "Ensure GitHub Actions OIDC trust policies only allows actions from a specific known organization"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-358
Check: CKV_AWS_108: "Ensure IAM policies does not allow data exfiltration"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration
Check: CKV_AWS_111: "Ensure IAM policies does not allow write access without constraints"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint
Check: CKV_AWS_49: "Ensure no IAM policies documents allow "*" as a statement's actions"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-43
Check: CKV_AWS_107: "Ensure IAM policies does not allow credentials exposure"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure
Check: CKV_AWS_356: "Ensure no IAM policies documents allow "*" as a statement's resource for restrictable actions"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-356
Check: CKV_AWS_109: "Ensure IAM policies does not allow permissions management / resource exposure without constraints"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint
Check: CKV_AWS_283: "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-283
Check: CKV_AWS_1: "Ensure IAM policies that allow full "*-*" administrative privileges are not created"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-23
Check: CKV_AWS_110: "Ensure IAM policies does not allow privilege escalation"
        PASSED for resource: aws_iam_policy_document.assume_role
        File: /main.tf:25-36
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation
Check: CKV_AWS_41: "Ensure no hard coded AWS access key and secret key exists in provider"
        PASSED for resource: aws.default
        File: /main.tf:4-4
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
        PASSED for resource: aws_iam_role.eks_developers
        File: /main.tf:38-42
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
        PASSED for resource: aws_iam_role.eks_developers
        File: /main.tf:38-42
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
        PASSED for resource: aws_iam_role.eks_developers
        File: /main.tf:38-42
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_AWS_274: "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy"
        PASSED for resource: aws_iam_role.eks_operators
        File: /main.tf:44-48
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274
Check: CKV_AWS_61: "Ensure AWS IAM policy does not allow assume role permission across all services"
        PASSED for resource: aws_iam_role.eks_operators
        File: /main.tf:44-48
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45
Check: CKV_AWS_60: "Ensure IAM role allows only specific services or principals to assume it"
        PASSED for resource: aws_iam_role.eks_operators
        File: /main.tf:44-48
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44
Check: CKV_TF_1: "Ensure Terraform module sources use a commit hash"
        SKIPPED for resource: eks
        Suppress comment: Hardcode a hash is not a best practice for minor and bug fixes versions.
        File: /eks.tf:5-133
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-git-url-with-commit-hash-revision
Check: CKV_TF_1: "Ensure Terraform module sources use a commit hash"
        SKIPPED for resource: vpc
        Suppress comment: Hardcode a hash is not a best practice for minor and bug fixes versions.
        File: /vpc.tf:5-30
        Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-git-url-with-commit-hash-revision